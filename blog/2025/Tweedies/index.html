<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>MMSE denoiser and Tweedie's Formula | Kyung Yun Lee</title> <meta name="author" content="Kyung Yun Lee"> <meta name="description" content="Diffusion Models Study"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%B6&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://kyungyunlee.github.io/blog/2025/Tweedies/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Kyung Yun </span>Lee</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">MMSE denoiser and Tweedie's Formula</h1> <p class="post-meta">December 6, 2025</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fas fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/statistics"> <i class="fas fa-hashtag fa-sm"></i> statistics,</a>   <a href="/blog/tag/diffusion"> <i class="fas fa-hashtag fa-sm"></i> diffusion</a>     ·   <a href="/blog/category/statistics"> <i class="fas fa-tag fa-sm"></i> statistics</a>   </p> </header> <article class="post-content"> <p>MMSE is an estimator that gives us the expectation of the posterior.</p> <p>Let \(x\) be a clean signal and \(\tilde{x}\) a noisy version of that:</p> \[\begin{align} \begin{aligned} \tilde{x} &amp;= x + \sigma \epsilon \\ \epsilon &amp;\sim N(0, I) \end{aligned} \end{align}\] <p>then, the MMSE denoiser is</p> \[\hat{x} = \mathbb{E}[x|\tilde{x}] = \int x p(x|\tilde{x}) dx = \int x \frac{p(\tilde{x}|x)p(x)}{p(\tilde{x})} dx\] <p>From the setup of the problem, we know that \(p(\tilde{x}\vert x) \sim N(x, \sigma^2)\), thus the marginal distribution of \(p(\tilde{x})\) is</p> \[p(\tilde{x}) = \int p(\tilde{x}|x) p(x) dx.\] <p>As a result, we can rewrite the MMSE denoiser as the following:</p> \[\mathbb{E}[x|\tilde{x}] = \frac{\int x p(\tilde{x}|x)p(x) dx}{\int p(\tilde{x}|x) p(x) dx}\] <p>We can simplify this formula using some trick, because there are things like \(p(x)\), which is intractable. This trick is what leads to the Tweedie’s formula.</p> <p>First, we call the numerator \(N(\tilde{x}) = \int x p(\tilde{x} \vert x)p(x) dx\) and the denominator \(m(\tilde{x}) = p(\tilde{x}) = \int p(\tilde{x} \vert x) p(x) dx\).</p> <p>The trick is to take the derivative of the marginal \(p(\tilde{x}) = m(\tilde{x})\).</p> \[\frac{d}{d\tilde{x}}m(\tilde{x}) = \frac{1}{\sigma^2} \int (x-\tilde{x}) p(\tilde{x}|x) p(x)dx\] \[= \frac{1}{\sigma^2}(N(\tilde{x}) - \tilde{x} m(\tilde{x}))\] <p>Then, we can represent the numerator \(N(\tilde{x})\) in terms of this gradient:</p> \[N(\tilde{x}) = \tilde{x} m(\tilde{x}) + \sigma^2 \frac{d}{d\tilde{x}}m(\tilde{x})\] <p>Plugging these back into the MMSE formula, we get</p> \[\mathbb{E}[x|\tilde{x}] = \frac{\tilde{x} m(\tilde{x}) + \sigma^2 \frac{d}{d\tilde{x}}m(\tilde{x}) }{m(\tilde{x})}\] \[= \tilde{x} + \sigma^2 \frac{d}{d\tilde{x}} \text{log} m(\tilde{x})\] \[= \tilde{x} + \sigma^2 \frac{d}{d\tilde{x}} \text{log} p(\tilde{x}),\] <p>which is the Tweedie’s formula.</p> <p>As \(\frac{d}{d\tilde{x}} \text{log} p(\tilde{x}) = \nabla_{\tilde{x}} \text{log} p(\tilde{x})\), this formula tells us that you can denoise a noisy signal just by correcting the noisy signal with the score function.</p> <p>The paper by Efron talks about the motivation behind it. The example in the paper is to estimate the means of many random variables each from single noisy observations. If you happen to observe only very extreme values, something that occurs under selection bias, these observations are simply inflated by noise.<br> Tweedie’s Formula corrects this inflation and allows you to estimate the debiased mean.</p> <h3 id="how-does-the-tweedies-formula-pop-up-in-diffusion-and-flow-models">How does the Tweedie’s formula pop up in diffusion and flow models?</h3> <p>Tweedie’s formula connects the MMSE denoiser and the score function. This connection is actually very fundamental in diffusion and flow models. Instead of learning the actual prior distribution directly, these models instead learn the conditional score function or conditional vector field, which is possible by the noising and denoising framework.</p> <p>At each time step of diffusion/flow model, the denoising step is essentially the Tweedie’s formula. Thus, by learning the score function or the vector field, the model can express the denoising process.</p> \[\mathbb{E}[x_0 | x_t]= x_t + \sigma_t^2 \nabla_{x_t} \text{log} p_{t}(x_t)\] <p>References</p> <ul> <li>Efron, Bradley. “Tweedie’s formula and selection bias.” Journal of the American Statistical Association 106.496 (2011): 1602-1614.</li> <li>Lai, Chieh-Hsin, et al. “The principles of diffusion models.” arXiv preprint arXiv:2510.21890 (2025).</li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Kyung Yun Lee. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>